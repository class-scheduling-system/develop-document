
<!DOCTYPE html>

<html class="no-js" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://bamboo-bookkeeping.doc.x-lf.cn/design/authorization/" rel="canonical"/>
<link href="../technical_architecture/" rel="prev"/>
<link href="../auto_scheduling/" rel="next"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.14" name="generator"/>
<title>授权模块设计 - 智课方舟</title>
<link href="../../assets/stylesheets/main.342714a4.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="https://unpkg.com/katex@0/dist/katex.min.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#_1">
          跳转至
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="页眉" class="md-header__inner md-grid">
<a aria-label="智课方舟" class="md-header__button md-logo" data-md-component="logo" href="../.." title="智课方舟">
<img alt="logo" src="../../../assets/images/favicon.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            智课方舟
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              授权模块设计
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="切换亮色模式" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="切换亮色模式">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
</label>
<input aria-label="切换暗色模式" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="blue" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="切换暗色模式">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="依照系统进行模式切换" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="blue-grey" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="依照系统进行模式切换">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="搜索" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="搜索" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="查找" class="md-search__options">
<a aria-label="分享" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="分享">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="清空当前内容" class="md-search__icon md-icon" tabindex="-1" title="清空当前内容" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/class-scheduling-system/develop-document" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    bamboo-services/develop-document
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="导航栏" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="智课方舟" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="智课方舟">
<img alt="logo" src="../../../assets/images/favicon.png"/>
</a>
    智课方舟
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/class-scheduling-system/develop-document" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    bamboo-services/develop-document
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    欢迎
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../information/">
<span class="md-ellipsis">
    开发信息
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../competition/">
<span class="md-ellipsis">
    赛题信息
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../requirements_specification/">
<span class="md-ellipsis">
    需求说明书
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
<span class="md-ellipsis">
    设计
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            设计
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
<span class="md-ellipsis">
    概要设计
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_1">
<span class="md-nav__icon md-icon"></span>
            概要设计
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../database/">
<span class="md-ellipsis">
    数据库设计
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../technical_architecture/">
<span class="md-ellipsis">
    技术架构设计
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
<span class="md-ellipsis">
    详细设计
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
            详细设计
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    授权模块设计
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    授权模块设计
    
  </span>
</a>
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1">
<span class="md-ellipsis">
      1. 功能概述
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2">
<span class="md-ellipsis">
      2. 系统架构
    </span>
</a>
<nav aria-label="2. 系统架构" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#21">
<span class="md-ellipsis">
      2.1 模块架构
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3">
<span class="md-ellipsis">
      3. 设计目标与约束
    </span>
</a>
<nav aria-label="3. 设计目标与约束" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#31">
<span class="md-ellipsis">
      3.1 设计目标
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#32">
<span class="md-ellipsis">
      3.2 系统约束
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4">
<span class="md-ellipsis">
      4. 核心流程
    </span>
</a>
<nav aria-label="4. 核心流程" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#41-token">
<span class="md-ellipsis">
      4.1 Token 生成流程
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#42-token">
<span class="md-ellipsis">
      4.2 Token 验证流程
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#43">
<span class="md-ellipsis">
      4.3 权限校验流程
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5">
<span class="md-ellipsis">
      5. 数据结构设计
    </span>
</a>
<nav aria-label="5. 数据结构设计" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#51-redis">
<span class="md-ellipsis">
      5.1 Redis 键值设计
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6">
<span class="md-ellipsis">
      6. 错误处理设计
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#7">
<span class="md-ellipsis">
      7. 测试用例设计
    </span>
</a>
<nav aria-label="7. 测试用例设计" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#71-token">
<span class="md-ellipsis">
      7.1 Token 验证测试
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#72">
<span class="md-ellipsis">
      7.2 权限校验测试
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#8">
<span class="md-ellipsis">
      8. 总结
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../auto_scheduling/">
<span class="md-ellipsis">
    自动排课设计
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ai_suggestion/">
<span class="md-ellipsis">
    AI 建议设计
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../teacher/">
<span class="md-ellipsis">
    教师设计
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../student/">
<span class="md-ellipsis">
    学生设计
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../user_register/">
<span class="md-ellipsis">
    教师（学生）与用户关系设计
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
<span class="md-ellipsis">
    开发
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            开发
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../develop/sql_prepare/">
<span class="md-ellipsis">
    关系型数据库准备
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../develop/nosql_prepare/">
<span class="md-ellipsis">
    非关系型数据库准备
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../develop/project_prepare/">
<span class="md-ellipsis">
    项目准备
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
<span class="md-ellipsis">
    项目总结
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            项目总结
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../final/project_overview/">
<span class="md-ellipsis">
    概要文档
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../final/algorithm/">
<span class="md-ellipsis">
    算法文档
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../final/project_detailed/">
<span class="md-ellipsis">
    详细文档
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../final/manuscript/">
<span class="md-ellipsis">
    视频文稿
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1">
<span class="md-ellipsis">
      1. 功能概述
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2">
<span class="md-ellipsis">
      2. 系统架构
    </span>
</a>
<nav aria-label="2. 系统架构" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#21">
<span class="md-ellipsis">
      2.1 模块架构
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3">
<span class="md-ellipsis">
      3. 设计目标与约束
    </span>
</a>
<nav aria-label="3. 设计目标与约束" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#31">
<span class="md-ellipsis">
      3.1 设计目标
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#32">
<span class="md-ellipsis">
      3.2 系统约束
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4">
<span class="md-ellipsis">
      4. 核心流程
    </span>
</a>
<nav aria-label="4. 核心流程" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#41-token">
<span class="md-ellipsis">
      4.1 Token 生成流程
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#42-token">
<span class="md-ellipsis">
      4.2 Token 验证流程
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#43">
<span class="md-ellipsis">
      4.3 权限校验流程
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5">
<span class="md-ellipsis">
      5. 数据结构设计
    </span>
</a>
<nav aria-label="5. 数据结构设计" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#51-redis">
<span class="md-ellipsis">
      5.1 Redis 键值设计
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6">
<span class="md-ellipsis">
      6. 错误处理设计
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#7">
<span class="md-ellipsis">
      7. 测试用例设计
    </span>
</a>
<nav aria-label="7. 测试用例设计" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#71-token">
<span class="md-ellipsis">
      7.1 Token 验证测试
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#72">
<span class="md-ellipsis">
      7.2 权限校验测试
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#8">
<span class="md-ellipsis">
      8. 总结
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="_1">授权模块设计文档</h1>
<div class="mermaid">flowchart TD
    A[用户登录] --&gt; B[生成 UUID 作为 Token]
    B --&gt; C[Token 和 UUID 存储到 Redis]
    C --&gt; D[返回 Token 给前端]

    E[前端携带 Token 请求接口] --&gt; F[验证 Token 格式]
    F --&gt; G{Token 是否存在于 Redis}
    G --&gt;|是| H[获取 UUID]
    G --&gt;|否| I[返回 401 Unauthorized]

    H --&gt; J[查询用户信息 Map]
    J --&gt; K{校验用户角色和权限}
    K --&gt;|权限足够| L[继续处理请求]
    K --&gt;|权限不足| M[返回 403 Forbidden]
</div>
<h2 id="1">1. 功能概述</h2>
<p>授权模块旨在为系统提供基于 Bearer Token 的用户身份认证与权限管理功能。采用 <strong>UUID</strong> 作为 Token 标识符，通过 <strong>Redis</strong> 存储和解析 Token 对应的用户信息。模块核心功能包括：</p>
<ul>
<li>验证前端发送的 Bearer Token 的有效性。</li>
<li>通过 Redis 获取 Token 对应的用户 UUID。</li>
<li>根据用户 UUID 检查用户信息 Map，校验用户角色权限。</li>
<li>对无效或过期的 Token 进行拦截，返回适当的错误响应。</li>
</ul>
<hr/>
<h2 id="2">2. 系统架构</h2>
<h3 id="21">2.1 模块架构</h3>
<p>授权模块主要由以下部分组成：</p>
<ol>
<li><strong>Token 生成模块</strong>：<ul>
<li>在用户登录成功后生成一个 UUID 作为 Token。</li>
<li>将生成的 Token 存储到 Redis，设定有效期。</li>
</ul>
</li>
<li><strong>Token 验证模块</strong>：<ul>
<li>验证前端发送的 Bearer Token 格式和有效性。</li>
<li>通过 Redis 检查 Token 是否存在并获取用户 UUID。</li>
</ul>
</li>
<li><strong>权限校验模块</strong>：<ul>
<li>根据 UUID 查询用户信息 Map，检查用户的角色权限。</li>
<li>根据用户角色权限进行分流限制。</li>
</ul>
</li>
<li><strong>错误处理模块</strong>：<ul>
<li>对于无效或过期的 Token，返回相应的错误状态（如 401 未授权）。</li>
</ul>
</li>
</ol>
<hr/>
<h2 id="3">3. 设计目标与约束</h2>
<h3 id="31">3.1 设计目标</h3>
<ol>
<li><strong>安全性</strong>：确保 Token 不可伪造和篡改。</li>
<li><strong>高效性</strong>：利用 Redis 的快速查询能力，提升授权流程效率。</li>
<li><strong>扩展性</strong>：支持多角色权限管理和分流限制。</li>
</ol>
<h3 id="32">3.2 系统约束</h3>
<ol>
<li><strong>Token 存储</strong>：<ul>
<li>Token 使用 UUID 格式，需保证唯一性。</li>
<li>Token 存储在 Redis 中，设置过期时间（如 1 天）。</li>
</ul>
</li>
<li><strong>Redis 存储结构</strong>：<ul>
<li>Token-UUID 映射：<code>bearer:&lt;token&gt; -&gt; &lt;uuid&gt;</code></li>
<li>用户信息 Map：<code>user:&lt;uuid&gt; -&gt; {role: "admin", name: "user1", permissions: [...]}</code></li>
</ul>
</li>
<li><strong>权限管理</strong>：<ul>
<li>支持角色（如 admin、user 等）和权限（如 read、write）两级校验。</li>
<li>针对不同角色的权限分流，限制访问某些资源。</li>
</ul>
</li>
</ol>
<hr/>
<h2 id="4">4. 核心流程</h2>
<h3 id="41-token">4.1 Token 生成流程</h3>
<ol>
<li>用户登录时，后端生成一个 UUID 作为 Token。</li>
<li>将 Token 和对应的用户 UUID 存储到 Redis，格式为：
   <code>Key: bearer:&lt;token&gt;
   Value: &lt;uuid&gt;
   Expiration: 30 minutes</code></li>
<li>将 Token 返回给前端，用于后续请求。</li>
</ol>
<h3 id="42-token">4.2 Token 验证流程</h3>
<ol>
<li>前端在请求头中携带 Token，格式如下：
   <code>Authorization: Bearer &lt;token&gt;</code></li>
<li>后端验证 Token 格式是否合法。</li>
<li>使用 Redis 查询 <code>bearer:&lt;token&gt;</code> 是否存在：<ul>
<li>如果存在，获取对应的用户 UUID。</li>
<li>如果不存在，返回 <code>401 Unauthorized</code>，提示 Token 无效或已过期。</li>
</ul>
</li>
</ol>
<h3 id="43">4.3 权限校验流程</h3>
<ol>
<li>根据用户 UUID 查询用户信息 Map（如 <code>user:&lt;uuid&gt;</code>）。</li>
<li>检查用户角色和权限是否符合当前请求的要求。</li>
<li>如果权限不足，返回 <code>403 Forbidden</code>；否则继续处理请求。</li>
</ol>
<hr/>
<h2 id="5">5. 数据结构设计</h2>
<h3 id="51-redis">5.1 Redis 键值设计</h3>
<table>
<thead>
<tr>
<th>Key 类型</th>
<th>Key 示例</th>
<th>Value 示例</th>
<th>过期时间</th>
</tr>
</thead>
<tbody>
<tr>
<td>Token-UUID 映射</td>
<td><code>bearer:abcd1234-5678-ef90-ghij-klmnopqrstuv</code></td>
<td><code>abcd1234-5678-ef90-ghij-klmnopqrstuv</code></td>
<td>30 分钟</td>
</tr>
<tr>
<td>用户信息 Map</td>
<td><code>user:abcd12345678ef90ghijklmnopqrstuv</code></td>
<td><code>{role: "admin", name: "user1", permissions: [...]}</code></td>
<td>不设置过期</td>
</tr>
</tbody>
</table>
<hr/>
<h2 id="6">6. 错误处理设计</h2>
<table>
<thead>
<tr>
<th>错误类型</th>
<th>错误代码</th>
<th>描述</th>
<th>解决方案</th>
</tr>
</thead>
<tbody>
<tr>
<td>Token 格式错误</td>
<td>400</td>
<td>请求头中未携带合法的 Token</td>
<td>返回错误信息提示，要求客户端提供正确的 Bearer Token 格式。</td>
</tr>
<tr>
<td>Token 无效</td>
<td>401</td>
<td>Token 不存在或已过期</td>
<td>提示用户重新登录获取新的 Token。</td>
</tr>
<tr>
<td>权限不足</td>
<td>403</td>
<td>用户角色或权限不足</td>
<td>返回权限不足提示，并说明所需的权限或角色要求。</td>
</tr>
</tbody>
</table>
<hr/>
<h2 id="7">7. 测试用例设计</h2>
<h3 id="71-token">7.1 Token 验证测试</h3>
<table>
<thead>
<tr>
<th>测试场景</th>
<th>输入 Token</th>
<th>预期结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>合法 Token</td>
<td><code>bearer:abcd1234-5678-ef90-ghij-klmnopqrstuv</code></td>
<td>返回对应用户 UUID，状态 200。</td>
</tr>
<tr>
<td>非法格式 Token</td>
<td><code>1234-5678-abcd</code></td>
<td>返回错误状态 400。</td>
</tr>
<tr>
<td>无效 Token</td>
<td><code>bearer:invalid-token-1234</code></td>
<td>返回错误状态 401。</td>
</tr>
<tr>
<td>过期 Token</td>
<td><code>bearer:expired-token-5678</code></td>
<td>返回错误状态 401。</td>
</tr>
</tbody>
</table>
<h3 id="72">7.2 权限校验测试</h3>
<table>
<thead>
<tr>
<th>测试场景</th>
<th>用户角色</th>
<th>请求资源</th>
<th>预期结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>用户权限匹配</td>
<td>admin</td>
<td>管理员资源</td>
<td>返回状态 200，正常访问。</td>
</tr>
<tr>
<td>用户权限不足</td>
<td>user</td>
<td>管理员资源</td>
<td>返回状态 403，权限不足。</td>
</tr>
<tr>
<td>未知用户角色</td>
<td>unknown</td>
<td>任意资源</td>
<td>返回状态 403，权限不足。</td>
</tr>
</tbody>
</table>
<hr/>
<h2 id="8">8. 总结</h2>
<p>本授权模块设计采用前端 Bearer Token 验证，结合 Redis 进行快速解析和用户信息查询，能够高效地实现身份认证与权限管理。通过灵活的 Redis 数据结构和权限分流设计，确保系统的安全性与可扩展性。</p>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  回到页面顶部
</button>
</main>
<footer class="md-footer">
<nav aria-label="页脚" class="md-footer__inner md-grid">
<a aria-label="上一页: 技术架构设计" class="md-footer__link md-footer__link--prev" href="../technical_architecture/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                上一页
              </span>
<div class="md-ellipsis">
                技术架构设计
              </div>
</div>
</a>
<a aria-label="下一页: 自动排课设计" class="md-footer__link md-footer__link--next" href="../auto_scheduling/">
<div class="md-footer__title">
<span class="md-footer__direction">
                下一页
              </span>
<div class="md-ellipsis">
                自动排课设计
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2022-2025 锋叶技术团队 All Righjs Reserved. 版权所有
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"base": "../..", "features": ["search", "search.suggest", "search.highlight", "search.share", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.footer", "navigation.sections", "toc.follow", "navigation.top"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
<script src="../../assets/js/extra.js"></script>
<script src="../../assets/js/katex.js"></script>
<script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
<script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
mermaid.initialize({});</script></body>
</html>